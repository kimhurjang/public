<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<footer th:fragment="footer">
    <div class="footerBox copy">
        <img src="/image/logo_1-2.png">
        <p>©ManHwaBangCho</p>
        <div id="snsIcon">
            <a href="" class="xi-facebook"></a>
            <a href="" class="xi-instagram"></a>
            <a href="" class="xi-kakaotalk"></a>
            <a href="" class="xi-twitter"></a>
        </div>
    </div>
    <div class="footerBox info">
        <div class="footerBox myAccount">
            <div th:if="${loginMember != null and loginMember.grade == 10}">
                <a href="/admin/content" target="_blank">관리자 페이지</a>
            </div>
            <div th:if="${loginMember != null and loginMember.grade == 1}">
                <p><b>내 정보</b></p>
                <p><a href="">마이 페이지</a></p>
                <p><a href="">예약 정보 조회 / 수정</a></p>
            </div>
        </div>
        <div class="footerBox address">
            <p><b>주소</b></p>
            <p>경상남도 고성군 거류면 은월리 17-5</p>
        </div>
        <div class="footerBox tel">
            <p><b>연락처</b></p>
            <p>TEL : 00-000-0000</p>
            <p>Email : abcd1234@mail.com</p>
        </div>
    </div>
    <!--패럴렉스 스크롤링 라이브러리 임폴트-->
    <script src="/js/jquery.parallax-scroll.min.js"></script>

    <!--제이쿼리 스크롤 효과 라이브러리 삽입-->
    <script src="/js/jquery.scrollTo.min.js"></script>

    <!--휠 효과 임폴트-->
    <script src="/js/wheel.js"></script>

    <script src="/js/main.js"></script>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
          const header = document.querySelector("header");
          const nav = document.querySelector("nav");
          const logo = document.querySelector(".logo");
          const mainSlide = document.querySelector("#ms1");
          const gnb = document.getElementById("gnb");
          const toggleBtn = document.querySelector(".toggle.icon");
          const navItems = document.querySelectorAll('#gnb .nav_item');
          const itemsWithSub = Array.from(gnb.querySelectorAll("li")).filter(li => li.querySelector(".sub_nav_layer"));
          const subMenuLinks = document.querySelectorAll('#gnb > li > strong > a');

          // 0) 초기 active 클래스 제거
          navItems.forEach(item => item.classList.remove('active'));

          if (window.innerWidth >= 765) {
              // 1) 스크롤 시 헤더 투명 제어
              function checkScroll() {
                if (!mainSlide) {
                  header.classList.add("transparentNav");
                  return;
                }
                if (window.scrollY <= mainSlide.offsetHeight - nav.offsetHeight) {
                  header.classList.remove("transparentNav");
                } else {
                  header.classList.add("transparentNav");
                }
              }
              checkScroll();
              window.addEventListener("scroll", checkScroll);

              // 2) GNB hover 효과 (데스크탑)
              navItems.forEach(item => {
                    item.addEventListener('mouseenter', () => {
                      navItems.forEach(i => i.classList.remove('active'));
                      item.classList.add('active');
                    });
                    item.addEventListener('mouseleave', () => {
                      item.classList.remove('active');
                    });
              });
          }

          if (window.innerWidth <= 764) {
          // 3) 외부 클릭 시 메뉴 닫기
          document.addEventListener("click", function(e) {
            if (!nav.contains(e.target)) {
              gnb.classList.remove("active");
              itemsWithSub.forEach(li => li.classList.remove("active"));
            }
          });

          // 4) 모바일 메뉴 아코디언
          subMenuLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                const li = link.closest('li');
                const sub = li.querySelector('.sub_group');
                if (sub) {
                  e.preventDefault();
                  const isActive = li.classList.contains('active');
                  document.querySelectorAll('#gnb > li').forEach(item => {
                    item.classList.remove('active');
                    const subMenu = item.querySelector('.sub_group');
                    if (subMenu) subMenu.style.maxHeight = '0';
                  });
                  if (!isActive) {
                    li.classList.add('active');
                    sub.style.maxHeight = (sub.scrollHeight + 40) + 'px';
                  }
                }
            });
          });

          // 5) 모바일에서 활성된 메뉴 자동 펼침
            document.querySelectorAll('#gnb > li.active .sub_group').forEach(sub => {
              sub.style.maxHeight = (sub.scrollHeight + 40) + 'px';
            });

          // 6) 헤더 토글
          if (toggleBtn) {
            toggleBtn.addEventListener('click', (e) => {
              e.preventDefault();
              header.classList.toggle('closed');
            });
          }
        }
          // 7) AOS 초기화
          AOS.init({
            duration: 600,
            easing: 'ease-in-out',
            delay: 0,
            offset: 10,
            once: false
          });
        });
        window.addEventListener('load', () => {
          AOS.refresh();
        });
    </script>

</footer>
</html>