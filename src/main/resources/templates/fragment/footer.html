<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<footer th:fragment="footer" class="bg-holder">
    <a href="#" class="scroll-top"><button class="btn xi-arrow-up"></button></a>

    <div class="footerBox copy">
        <img src="/image/logo_1-2.png">
        <p>©ManHwaBangCho</p>
        <div id="snsIcon">
            <a href="" class="xi-facebook"></a>
            <a href="" class="xi-instagram"></a>
            <a href="" class="xi-kakaotalk"></a>
            <a href="" class="xi-twitter"></a>
        </div>
    </div>
    <div class="footerBox info">
        <div class="footerBox myAccount">
            <div th:if="${loginMember != null and loginMember.grade == 10}">
                <a href="/admin/content" target="_blank">관리자 페이지</a>
            </div>
            <div th:if="${loginMember != null and loginMember.grade == 1}">
                <p><b>내 정보</b></p>
                <p><a href="">마이 페이지</a></p>
                <p><a href="">예약 정보 조회 / 수정</a></p>
            </div>
        </div>
        <div class="footerBox address">
            <p><b>주소</b></p>
            <p>경상남도 고성군 거류면 은월리 17-5</p>
        </div>
        <div class="footerBox tel">
            <p><b>연락처</b></p>
            <p>TEL : 00-000-0000</p>
            <p>Email : abcd1234@mail.com</p>
        </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <!--제이쿼리 스크롤 효과 라이브러리 삽입
    <script src="/js/jquery.scrollTo.min.js"></script>-->
    <script src="/js/comm.js"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3bf69ce9275feb61004f536b17f363b9"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
          const header = document.querySelector("header");
          const nav = document.querySelector("nav");
          const mainSlide = document.querySelector("#ms1");
          const gnb = document.getElementById("gnb");
          const toggleBtn = document.querySelector(".toggle.icon");
          const navItems = document.querySelectorAll('#gnb .nav_item');
          const itemsWithSub = Array.from(gnb.querySelectorAll("li")).filter(li => li.querySelector(".sub_nav_layer"));
          const subMenuLinks = document.querySelectorAll('#gnb > li > strong > a');

          // 0) 초기 active 제거
          navItems.forEach(item => item.classList.remove('active'));

          // 1) 데스크탑 - 스크롤 시 헤더 투명화
          if (window.innerWidth >= 765) {
            function checkScroll() {
              if (!mainSlide) {
                header.classList.add("transparentNav");
                return;
              }
              if (window.scrollY <= mainSlide.offsetHeight - nav.offsetHeight) {
                header.classList.remove("transparentNav");
              } else {
                header.classList.add("transparentNav");
              }
            }
            checkScroll();
            window.addEventListener("scroll", checkScroll);

            // 2) GNB hover 효과
            navItems.forEach(item => {
              item.addEventListener('mouseenter', () => {
                navItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
              });
              item.addEventListener('mouseleave', () => {
                item.classList.remove('active');
              });
            });
          }

          // 3) 모바일 메뉴 제어
          if (window.innerWidth <= 764) {
            // 메뉴 외부 클릭 시 오버레이 감지하여 닫기
            document.addEventListener("click", function (e) {
              if (document.body.classList.contains('menu_open')) {
                const isInsideMenu = e.target.closest("#gnb") || e.target.closest(".toggle.icon");
                if (!isInsideMenu) {
                  gnb.classList.remove("active");
                  header.classList.remove("closed");
                  document.body.classList.remove("menu_open");
                  itemsWithSub.forEach(li => li.classList.remove("active"));
                }
              }
            });

            // 아코디언 메뉴 동작
            subMenuLinks.forEach(link => {
              link.addEventListener('click', (e) => {
                const li = link.closest('li');
                const sub = li.querySelector('.sub_group');
                if (sub) {
                  e.preventDefault();
                  const isActive = li.classList.contains('active');
                  document.querySelectorAll('#gnb > li').forEach(item => {
                    item.classList.remove('active');
                    const subMenu = item.querySelector('.sub_group');
                    if (subMenu) subMenu.style.maxHeight = '0';
                  });
                  if (!isActive) {
                    li.classList.add('active');
                    sub.style.maxHeight = (sub.scrollHeight + 40) + 'px';
                  }
                }
              });
            });

            // 활성된 메뉴 자동 펼침
            document.querySelectorAll('#gnb > li.active .sub_group').forEach(sub => {
              sub.style.maxHeight = (sub.scrollHeight + 40) + 'px';
            });

            // 햄버거 토글 버튼
            if (toggleBtn) {
              toggleBtn.addEventListener('click', (e) => {
                e.preventDefault();
                header.classList.toggle('closed');
                gnb.classList.toggle('active');
                document.body.classList.toggle('menu_open');
              });
            }
          }
        });

        // 뒤로가기 버튼
        function goBack() {
          history.back();
        }


    </script>

    <!-- 맵스 스크립트-->
    <script>
        //카카오 맵스
        var container = document.getElementById('map'); //지도를 담을 영역의 DOM 레퍼런스
        var options = { //지도를 생성할 때 필요한 기본 옵션
            center: new kakao.maps.LatLng(34.960784, 128.385700), //지도의 중심좌표.
            level: 3 //지도의 레벨(확대, 축소 정도)
        };

        var map = new kakao.maps.Map(container, options);
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(34.960784, 128.385700), // 지도의 중심좌표
            level: 3 // 지도의 확대 레벨
        };

        var map = new kakao.maps.Map(mapContainer, mapOption);

        var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소입니다
            imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
            imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

        // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption),
            markerPosition = new kakao.maps.LatLng(34.960784, 128.385700); // 마커가 표시될 위치입니다

        // 마커를 생성합니다
        var marker = new kakao.maps.Marker({
          position: markerPosition,
          image: markerImage // 마커이미지 설정
        });

        // 마커가 지도 위에 표시되도록 설정합니다
        marker.setMap(map);

        // 커스텀 오버레이에 표출될 내용으로 HTML 문자열이나 document element가 가능합니다
        var content = '<div class="customoverlay">' +
            '  <a href="https://map.kakao.com/link/map/11394059" target="_blank">' +
            '    <span class="title">만화방초</span>' +
            '  </a>' +
            '</div>';

        // 커스텀 오버레이가 표시될 위치입니다
        var position = new kakao.maps.LatLng(37.54699, 127.09598);

        // 커스텀 오버레이를 생성합니다
        var customOverlay = new kakao.maps.CustomOverlay({
            map: map,
            position: position,
            content: content,
            yAnchor: 1
        });

        // 지도타입 컨트롤의 지도 또는 스카이뷰 버튼을 클릭하면 호출되어 지도타입을 바꾸는 함수입니다
        function setMapType(maptype) {
            var roadmapControl = document.getElementById('btnRoadmap');
            var skyviewControl = document.getElementById('btnSkyview');
            if (maptype === 'roadmap') {
                map.setMapTypeId(kakao.maps.MapTypeId.ROADMAP);
                roadmapControl.className = 'selected_btn';
                skyviewControl.className = 'btn';
            } else {
                map.setMapTypeId(kakao.maps.MapTypeId.HYBRID);
                skyviewControl.className = 'selected_btn';
                roadmapControl.className = 'btn';
            }
        }

        // 지도 확대, 축소 컨트롤에서 확대 버튼을 누르면 호출되어 지도를 확대하는 함수입니다
        function zoomIn() {
            map.setLevel(map.getLevel() - 1);
        }

        // 지도 확대, 축소 컨트롤에서 축소 버튼을 누르면 호출되어 지도를 확대하는 함수입니다
        function zoomOut() {
            map.setLevel(map.getLevel() + 1);
        }
    </script>

    <th:block layout:fragment="js">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <!--패럴렉스 스크롤링 라이브러리 임폴트-->
        <script src="/js/jquery.parallax-scroll.min.js"></script>
        <!--휠 효과 임폴트-->
        <script src="/js/wheel.js"></script>
    </th:block>
</footer>
</html>