<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<footer th:fragment="footer">
    <div class="footerBox copy">
        <img src="./image/logo_1-2.png">
        <p>©ManHwaBangCho</p>
        <div id="snsIcon">
            <a href="" class="xi-facebook"></a>
            <a href="" class="xi-instagram"></a>
            <a href="" class="xi-kakaotalk"></a>
            <a href="" class="xi-twitter"></a>
        </div>
    </div>
    <div class="footerBox info">
        <div class="footerBox myAccount">
            <div th:if="${session.loginMember != null and session.loginMember.grade == 10}">
                <a href="/admin/content" target="_blank">관리자 페이지</a>
            </div>
            <div th:if="${session.loginMember != null and session.loginMember.grade == 1}">
                <p>내 정보</p>
                <p><a href="">마이 페이지</a></p>
                <p><a href="">예약 정보 조회 / 수정</a></p>
            </div>
        </div>
        <div class="footerBox address">
            <p>주소</p>
            <p>경상남도 고성군 거류면 은월리 17-5</p>
        </div>
        <div class="footerBox tel">
            <p>연락처</p>
            <p>TEL : 00-000-0000</p>
            <p>Email : abcd1234@mail.com</p>
        </div>
    </div>
    <!--패럴렉스 스크롤링 라이브러리 임폴트-->
    <script src="/js/jquery.parallax-scroll.min.js"></script>

    <!--제이쿼리 스크롤 효과 라이브러리 삽입-->
    <script src="/js/jquery.scrollTo.min.js"></script>

    <!--휠 효과 임폴트-->
    <script src="/js/wheel.js"></script>

    <script src="/js/main.js"></script>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
          const nav       = document.querySelector("nav");
          const logo      = document.querySelector(".logo");
          const mainSlide = document.querySelector("#ms1");
          const gnb       = document.getElementById("gnb");
          const toggleBtn = gnb.querySelector(".toggle.icon");
          const itemsWithSub = Array.from(gnb.querySelectorAll("li"))
                                    .filter(li => li.querySelector(".sub_nav_layer"));
          let hideTimeout;

          // —————————————
          // 1) 스크롤 투명 내비 제어
          // —————————————
          function checkScroll() {
            if (!mainSlide) {
              nav.classList.remove("transparentNav");
              logo.classList.remove("transparentNav");
              return;
            }
            if (window.scrollY <= mainSlide.offsetHeight - nav.offsetHeight) {
              nav.classList.add("transparentNav");
              logo.classList.add("transparentNav");
            } else {
              nav.classList.remove("transparentNav");
              logo.classList.remove("transparentNav");
            }
          }

          // 초기 및 스크롤 이벤트
          checkScroll();
          window.addEventListener("scroll", checkScroll);

          // —————————————
          // 2) 데스크탑 서브 메뉴 hover → CSS :hover 로 처리
          //    (JS 로 제어하길 원하시면 itemsWithSub.forEach로 mouseenter/leave 추가)
          // —————————————

          // —————————————
          // 3) 모바일: 전체 GNB 토글
          // —————————————
          toggleBtn.addEventListener("click", function(e) {
            e.stopPropagation();
            gnb.classList.toggle("active");
            // 열린 GNB 닫을 때, 열려있던 서브도 모두 닫기
            if (!gnb.classList.contains("active")) {
              itemsWithSub.forEach(li => li.classList.remove("active"));
            }
          });

          // —————————————
          // 4) 모바일: 각 has-sub 클릭해서 서브 열기/닫기
          // —————————————
          itemsWithSub.forEach(li => {
            const anchor = li.querySelector("a.nav_item");
            anchor.addEventListener("click", function(e) {
              if (window.innerWidth <= 764) {
                e.preventDefault();
                e.stopPropagation();
                li.classList.toggle("active");
              }
            });
          });

          // —————————————
          // 5) 외부 클릭 시 GNB 및 열린 서브 모두 닫기
          // —————————————
          document.addEventListener("click", function(e) {
            if (!nav.contains(e.target)) {
              gnb.classList.remove("active");
              itemsWithSub.forEach(li => li.classList.remove("active"));
            }
          });
        });

        AOS.init({
           duration: 600,  // 애니메이션 지속 시간 (밀리초)
           easing: 'ease-in-out',  // 애니메이션의 이징 함수
           delay: 0,  // 애니메이션 지연 시간 (밀리초)
           offset: 10,  // 스크롤 감지의 시작 위치 (픽셀)
            once: false
         });
        window.addEventListener('load', () => {
          AOS.refresh();
          checkScroll(); // 이 위치에서 호출
        });

    </script>
</footer>
</html>